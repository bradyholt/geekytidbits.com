<!doctype html>
<html amp lang="en">
<head>
    <meta charset="utf-8">
    <title>Convert current Epoch time to Local time in SQL Server</title>
    <link rel="canonical" href="https://www.geekytidbits.com/convert-current-epoch-time-to-local-time-in-sql-server/" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Poly' rel='stylesheet'>
    <style amp-custom>
        body { font-family: 'Poly', serif; }
        .site-header { background-color: #237ab2; color: #e7e9ec; padding: 5px; font-weight: 100; border-bottom: 3px solid #f68905; }
        .site-description { font-size: .5em;}        
        .post-content { padding: 10px; }
    </style>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
    <script async custom-element="amp-video" src="https://cdn.ampproject.org/v0/amp-video-0.1.js"></script>
    <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
</head>

<body>
    
    <h1 class="post-title">
        <header class="site-header">
    <div class="wrapper">
        <a class="site-title" href="/">
            <amp-img src="/media/geekytidbits.png" width="383" height="46" alt="Geeky Tidbits Logo" layout="responsive"><noscript><img src="/media/geekytidbits.png" width="383" height="46" alt="Geeky Tidbits Logo"></noscript></amp-img>
        </a>
        <div class="site-description">Tidbits on software development, technology, and other geeky stuff.</div>
    </div>
</header>

    </h1>
    <div class="post-content">
      <span>
          <i>Jul 13, 2012</i>
      </span>
      <p>Epoch, or <a href="http://en.wikipedia.org/wiki/Unix_time" target="_blank">Unix time</a>, is a measure of time represented by the number of seconds since  midnight on January 1, 1970 (UTC).  It is used in various places, especially in POSIX systems such as Unix, Linux, BSD, etc.  I recently came across an integration project where I had the need to convert current epoch time to the ‘local’ timezone in SQL Server.  Here is what I ended up with.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">DECLARE</span> <span class="o">@</span><span class="n">epoch</span> <span class="n">int</span>
<span class="k">SET</span> <span class="o">@</span><span class="n">epoch</span> <span class="o">=</span> <span class="mi">1342189899</span> <span class="c1">--7/13/2012 14:31:39 UTC</span>
<span class="n">PRINT</span> <span class="n">DATEADD</span><span class="p">(</span><span class="k">minute</span><span class="p">,</span> <span class="n">DATEDIFF</span><span class="p">(</span><span class="k">minute</span><span class="p">,</span> <span class="n">getutcdate</span><span class="p">(),</span> <span class="n">getdate</span><span class="p">()),</span> <span class="n">DATEADD</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">@</span><span class="n">epoch</span><span class="p">,</span> <span class="s1">'19700101 00:00:00:000'</span><span class="p">))</span>
<span class="c1">--output: Jul 13 2012  9:31AM</span>
</code></pre></div></div>

<p>See it in action on <strong>SQL Fiddle</strong> here: <a href="http://sqlfiddle.com/#!3/d41d8/2617/0" target="_blank">http://sqlfiddle.com/#!3/d41d8/2617/0</a></p>

<p>Note:  The above approach works well for ‘current’ epoch timestamps  but is flawed if you are trying to convert historical epoch times, because of the daylight savings time (DST) factor.  The UTC offset calculation above (DATEDIFF(minute, getutcdate(), getdate())) is relying upon current system time and is not DST aware.  In my particular case this is not an issue because I have an external system that is writing new records with a ‘current epoch timestamp’ so I convert them to the local timezone soon thereafter and store the result.</p>

    </div>
    
    <footer class="site-footer">
    © 2019 Brady Holt
</footer>

    <amp-analytics type="googleanalytics">
        <script type="application/json">
        {
            "vars": {
            "account": "UA-19416043-2"
            },
            "triggers": {
            "trackPageview": {
                "on": "visible",
                "request": "pageview"
            }
            }
        }
        </script>
    </amp-analytics>
</body>

</html>