<!doctype html>
<html amp lang="en">
<head>
    <meta charset="utf-8">
    <title>Easy HTTPS with Cloudflare</title>
    <link rel="canonical" href="https://www.geekytidbits.com/easy-https-with-cloudflare/" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Poly' rel='stylesheet'>
    <style amp-custom>
        body { font-family: 'Poly', serif; }
        .site-header { background-color: #237ab2; color: #e7e9ec; padding: 5px; font-weight: 100; border-bottom: 3px solid #f68905; }
        .site-description { font-size: .5em;}        
        .post-content { padding: 10px; }
    </style>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
    <script async custom-element="amp-video" src="https://cdn.ampproject.org/v0/amp-video-0.1.js"></script>
    <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
</head>

<body>
    
    <h1 class="post-title">
        <header class="site-header">
    <div class="wrapper">
        <a class="site-title" href="/">
            <amp-img src="/media/geekytidbits.png" width="383" height="46" alt="Geeky Tidbits Logo" layout="responsive"><noscript><img src="/media/geekytidbits.png" width="383" height="46" alt="Geeky Tidbits Logo"></noscript></amp-img>
        </a>
        <div class="site-description">Tidbits on software development, technology, and other geeky stuff.</div>
    </div>
</header>

    </h1>
    <div class="post-content">
      <span>
          <i>Jan 10, 2017</i>
      </span>
      <p>HTTPS everywhere!  This is the trend of late, and for good reason.  Phishing, connection snooping, man-in-the-middle attacks and hacking in general is pervasive today and security on the web is more important than ever.</p>

<p>I think Google played a bit part in this push, starting with their 2014 <a href="https://webmasters.googleblog.com/2014/08/https-as-ranking-signal.html">HTTP as a ranking signal</a> post where they announced they would start taking SSL into account in their search rankings.  Although it’s weighted only a small amount, in that post they left open the possibility for a heavier weighting in the future.  Then, they put some money behind this call to action by helping to fund <a href="https://letsencrypt.org/">Let’s Encrypt</a>, a non-profit certificate authority giving away free SSL certificates.  Finally, in 2016 their <a href="https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html">Moving towards a more secure web</a> post really struck some fear in site owners everywhere with the announcement they they will eventually start showing regular HTTP connections like this:</p>

<p><amp-img src="/media/chrome-not-secure.png" alt="Chrome Not Secure Warning" width="1152" height="559" layout="responsive"><noscript><img src="/media/chrome-not-secure.png" alt="Chrome Not Secure Warning" width="1152" height="559"></noscript></amp-img></p>

<p>That is a pretty strong imperative to get HTTPS on your site, ASAP.  Regardless of how you feel about the need for HTTPS on your simple blog site, the fact that Chrome users (FireFox, Edge and others will surely follow suit) will see this warning on your site is downright jolting.</p>

<p>The good news is, it’s easier and cheaper (free!) than ever to get HTTPS setup on your site.  To get my blog running on HTTPS, I decided to use Cloudflare which makes it trival.  Let’s walk through the setup.</p>

<h3 id="initial-setup">Initial Setup</h3>

<ul>
  <li>Signup for a Cloudflare account at <a href="https://www.cloudflare.com/a/sign-up">https://www.cloudflare.com/a/sign-up</a>.</li>
  <li>Click “Add Site” at the top, enter your domain name, and click “Begin Scan”.</li>
</ul>

<p><amp-img src="/media/cloudflare-step-1.png" alt="Cloudflare Add Site" width="858" height="505" layout="responsive"><noscript><img src="/media/cloudflare-step-1.png" alt="Cloudflare Add Site" width="858" height="505"></noscript></amp-img></p>

<ul>
  <li>Once the scan is done, click “Continue Setup”, and review your DNS records.  Most likely, you can leave these as is.  Cloudflare defaults your DNS records based on the current setup at your existing nameserver.  Once you’ve reviewed, click “Continue”.</li>
</ul>

<p><amp-img src="/media/cloudflare-step-2.png" alt="Cloudflare DNS Records" width="738" height="329" layout="responsive"><noscript><img src="/media/cloudflare-step-2.png" alt="Cloudflare DNS Records" width="738" height="329"></noscript></amp-img></p>

<ul>
  <li>Choose the “Free Website” plan.  Free is nice.</li>
</ul>

<p><amp-img src="/media/cloudflare-step-3.png" alt="Cloudflare Free Plan" width="717" height="336" layout="responsive"><noscript><img src="/media/cloudflare-step-3.png" alt="Cloudflare Free Plan" width="717" height="336"></noscript></amp-img></p>

<ul>
  <li>
    <p>Follow the instructions to change your domain nameserver to Cloudflare.</p>
  </li>
  <li>
    <p>Click “Continue” and continue to the “Overview” screen. <amp-img src="/media/cloudflare-overview.png" alt="Cloudflare Automatic HTTPS Rewrites" width="76" height="96" layout="responsive"><noscript><img src="/media/cloudflare-overview.png" alt="Cloudflare Automatic HTTPS Rewrites" width="76" height="96"></noscript></amp-img></p>
  </li>
  <li>
    <p>Your Domain Summary should show SSL: Flexible.</p>
  </li>
</ul>

<p><amp-img src="/media/cloudflare-step-4.png" alt="Cloudflare SSL Setting" width="378" height="160" layout="responsive"><noscript><img src="/media/cloudflare-step-4.png" alt="Cloudflare SSL Setting" width="378" height="160"></noscript></amp-img></p>

<h3 id="https-rewrites">HTTPS Rewrites</h3>

<p>Even if you serve your site over HTTPS, if you have resources or links pointing to non-secure HTTP URLs, browsers will display a mixed-content security warning which you want to avoid.  Ideally, you can update these references in your site itself (and do so going forward) but there is a setting in Cloudflare called “Automatic HTTPS Rewrites” we will use that is a nice stop-gap solution for existing references or ones you missed.</p>

<ul>
  <li>
    <p>At the top of the screen, click the Crypto icon <amp-img src="/media/cloudflare-crypto.png" alt="Cloudflare Crypto" width="70" height="92" layout="responsive"><noscript><img src="/media/cloudflare-crypto.png" alt="Cloudflare Crypto" width="70" height="92"></noscript></amp-img></p>
  </li>
  <li>
    <p>Scroll down to the bottom and toggle “Automatic HTTPS Rewrites” On.</p>
  </li>
</ul>

<p><amp-img src="/media/cloudflare-step-5.png" alt="Cloudflare Automatic HTTPS Rewrites" width="713" height="239" layout="responsive"><noscript><img src="/media/cloudflare-step-5.png" alt="Cloudflare Automatic HTTPS Rewrites" width="713" height="239"></noscript></amp-img></p>

<h3 id="forcing-https">Forcing HTTPS</h3>

<p>Finally, we’ll create a Page Rule to force HTTPS on the site.  This means thet anyone accessing the http:// scheme for your site will be redirected to the https:// scheme.</p>

<ul>
  <li>
    <p>Click on the “Page Rules” icon at the top of the site <amp-img src="/media/cloudflare-page-rules.png" alt="Cloudflare Page Rules" width="85" height="91" layout="responsive"><noscript><img src="/media/cloudflare-page-rules.png" alt="Cloudflare Page Rules" width="85" height="91"></noscript></amp-img></p>
  </li>
  <li>
    <p>Click “Create Page Rule”, specify http://<em>[youdomainhere.com]/</em> in the “If the URL matches” textbox and select “Always Use HTTPS” for the setting.</p>
  </li>
</ul>

<p><amp-img src="/media/cloudflare-step-6.png" alt="Cloudflare Force HTTPS" width="791" height="450" layout="responsive"><noscript><img src="/media/cloudflare-step-6.png" alt="Cloudflare Force HTTPS" width="791" height="450"></noscript></amp-img></p>

<h3 id="done">Done!</h3>

<p>Now, all you need to do is wait for the nameserver changes to propagate which can take up to 24 hours.  Once this process is complete, your site is setup with HTTPS.</p>

<p>That was easy.</p>

    </div>
    
    <footer class="site-footer">
    © 2019 Brady Holt
</footer>

    <amp-analytics type="googleanalytics">
        <script type="application/json">
        {
            "vars": {
            "account": "UA-19416043-2"
            },
            "triggers": {
            "trackPageview": {
                "on": "visible",
                "request": "pageview"
            }
            }
        }
        </script>
    </amp-analytics>
</body>

</html>