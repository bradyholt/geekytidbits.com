<!doctype html>
<html amp lang="en">
<head>
    <meta charset="utf-8">
    <title>Opening Garage Doors with a Raspberry Pi</title>
    <link rel="canonical" href="https://www.geekytidbits.com/open-garage-doors-raspberry-pi/" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Poly' rel='stylesheet'>
    <style amp-custom>
        body { font-family: 'Poly', serif; }
        .site-header { background-color: #237ab2; color: #e7e9ec; padding: 5px; font-weight: 100; border-bottom: 3px solid #f68905; }
        .site-description { font-size: .5em;}        
        .post-content { padding: 10px; }
    </style>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
    <script async custom-element="amp-video" src="https://cdn.ampproject.org/v0/amp-video-0.1.js"></script>
    <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
</head>

<body>
    
    <h1 class="post-title">
        <header class="site-header">
    <div class="wrapper">
        <a class="site-title" href="/">
            <amp-img src="/media/geekytidbits.png" width="383" height="46" alt="Geeky Tidbits Logo" layout="responsive"><noscript><img src="/media/geekytidbits.png" width="383" height="46" alt="Geeky Tidbits Logo"></noscript></amp-img>
        </a>
        <div class="site-description">Tidbits on software development, technology, and other geeky stuff.</div>
    </div>
</header>

    </h1>
    <div class="post-content">
      <span>
          <i>Dec 22, 2016</i>
      </span>
      <p>About 5 years ago, <a href="/iphone-control-house-alarm-and-garage-doors/">I wrote about a solution</a> I had for controlling my garage doors from my phone. It was a fun project and generally has been working well. However, the triggering mechanism relies upon X10 through my Honeywell Vista 20-P alarm panel and is therefore not very transferable to others wanting to do a similar project. When friends ask about it and the possibility of doing their own similar project, I always have to hestitate a bit and say “well, it’s a pretty specific setup to my house and equipment”. I really have wanted to say “sure, here’s a blog post showing you each step so you can do a project for yourself”.</p>

<p>I’ve been having more issues with X10 interference lately and decided to dust off one of my Raspberry Pi devices and put it to use as an alternative solution that should surely be more reliable and a fun project along the way!</p>

<p>As a precursor to this project, I was playing around with the GPIO pins and my multimeter to see if I could control them with the <a href="https://github.com/jperkin/node-rpio">Node rpio library</a> and posted about it on Twitter.</p>

<blockquote class="twitter-tweet" data-lang="en">
<p lang="en" dir="ltr">I'm totally geeking out over here with using JavaScript to apply 3V to my RaspberryPi GPIO pins: <a href="https://t.co/CfYiDLYFCB">https://t.co/CfYiDLYFCB</a></p>— Brady Holt (@bradymholt) <a href="https://twitter.com/bradymholt/status/809021240329564160">December 14, 2016</a>
</blockquote>
<script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>Once I was able to get this working, I knew getting the Pi hooked up to a relay and then triggering my garage door openers would be easy.</p>

<h2 id="parts-list">Parts List</h2>

<p>Let’s get started. Here’s what you’ll need:</p>

<ul>
  <li>
<a href="https://www.amazon.com/LoveRPi-Raspberry-Plug-Play-Starter/dp/B01IYBZEV6">Raspberry Pi 3 Starter Kit</a> (includes power adapter and 8GB SD Card)</li>
  <li><a href="https://www.amazon.com/gp/product/B00E0NTPP4">2 Channel DC 5V Relay Module</a></li>
  <li><a href="https://www.amazon.com/gp/product/B017NEGTXC">Female to Female Jumper Wires</a></li>
</ul>

<p><amp-img src="/media/raspberry-pi-relay-parts.png" alt="Raspberry Pi Relay Parts List" width="755" height="654" layout="responsive"><noscript><img src="/media/raspberry-pi-relay-parts.png" alt="Raspberry Pi Relay Parts List" width="755" height="654"></noscript></amp-img></p>

<h2 id="hardware-setup">Hardware Setup</h2>

<p>Using 4 Female to Female jumper wires, connect the Raspberry Pi to the relay:</p>

<table>
  <thead>
    <tr>
      <th>RPi Pin</th>
      <th>Relay Pin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Pin 6 (Ground)</td>
      <td>GND</td>
    </tr>
    <tr>
      <td>Pin 11 (GPIO 0)</td>
      <td>IN1</td>
    </tr>
    <tr>
      <td>Pin 12 (GPIO 1)</td>
      <td>IN2</td>
    </tr>
    <tr>
      <td>Pin 2 (5V)</td>
      <td>VCC</td>
    </tr>
  </tbody>
</table>

<p><a href="/media/raspberry-pi-3-pin-connections-relay.png" target="_blank"><amp-img alt="Raspberry Pi Pin Connections to Relay" src="/media/raspberry-pi-3-pin-connections-relay.png" width="1200" height="860" layout="responsive"><noscript><img alt="Raspberry Pi Pin Connections to Relay" src="/media/raspberry-pi-3-pin-connections-relay.png" width="1200" height="860"></noscript></amp-img></a></p>

<h2 id="software-setup">Software Setup</h2>

<p>Now that the relay is connected to the pins, it’s time to setup the OS and software we will use to control the relays.</p>

<p><a href="https://archlinuxarm.org/">Arch Linux ARM</a> will be used as the OS and the <a href="https://github.com/bradymholt/raspberrypi-relay-controller">raspberrypi-relay-controller</a> project will be used to provision the Pi with Ansible and install all necessary software. This will make setting up the Raspberry Pi software very straightforward. Rather than rehashing all the raspberrypi-relay-controller instructions here, simply follow the <a href="https://github.com/bradymholt/raspberrypi-relay-controller/blob/master/README.md">README</a> step-by-step. In short, you will doing the following:</p>

<ol>
  <li>Install Arch Linux ARM on SD card and then booting the Raspberry Pi</li>
  <li>Setup up key-based authentication for root user</li>
  <li>Run Ansible playbook to provision all necessary software and configuration</li>
</ol>

<p>Once you are done with the instructions, you should be able to open http://[raspberry_ip_address]:3000 in a browser and see the following simple web interface that allows triggering of the relays.</p>

<p><amp-img src="/media/relay-controller-web-interface.png" alt="Relay Web Interface" width="360" height="640" layout="responsive"><noscript><img src="/media/relay-controller-web-interface.png" alt="Relay Web Interface" width="360" height="640"></noscript></amp-img></p>

<p>Although there are several components at play, the actual control of the relay is handled by a <a href="https://github.com/bradymholt/raspberrypi-relay-controller/blob/master/roles/relay-rest-api/templates/server.js.j2">Node.js process</a> that utilizies <a href="https://github.com/jperkin/node-rpio">rpio</a> to trigger the relay temporarily using this block of code:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">toggleGpioPinOn</span><span class="p">(</span><span class="nx">pin</span><span class="p">,</span> <span class="nx">durationMilliseconds</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Set the initial state to low.</span>
  <span class="nx">rpio</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">pin</span><span class="p">,</span> <span class="nx">rpio</span><span class="p">.</span><span class="nx">OUTPUT</span><span class="p">,</span> <span class="nx">rpio</span><span class="p">.</span><span class="nx">LOW</span><span class="p">);</span>
  <span class="c1">// Turn pin ON.</span>
  <span class="nx">rpio</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">pin</span><span class="p">,</span> <span class="nx">rpio</span><span class="p">.</span><span class="nx">HIGH</span><span class="p">);</span>
  <span class="c1">// Wait durationMilliseconds</span>
  <span class="nx">rpio</span><span class="p">.</span><span class="nx">msleep</span><span class="p">(</span><span class="nx">durationMilliseconds</span><span class="p">);</span>
  <span class="c1">// Turn pin OFF.</span>
  <span class="nx">rpio</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">pin</span><span class="p">,</span> <span class="nx">rpio</span><span class="p">.</span><span class="nx">LOW</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="conection-to-garage-door-openers">Conection to Garage Door Openers</h2>

<ol>
  <li>Run <code class="highlighter-rouge">sudo shutdown</code> and then unplug the Pi</li>
  <li>Connect 2 wires from each garage door opener switch contacts to the relay. The switch contacts are usually labeled White and Black and will be the same ones your wall switch(es) are attached to.</li>
  <li>Plug back in the Pi and let it boot</li>
</ol>

<p><a href="/media/relay_to_garage_door_connection.png" target="_blank"><amp-img alt="Relay to Garage Door Connection" src="/media/relay_to_garage_door_connection.png" width="1200" height="515" layout="responsive"><noscript><img alt="Relay to Garage Door Connection" src="/media/relay_to_garage_door_connection.png" width="1200" height="515"></noscript></amp-img></a></p>

<p>Here is what my Pi looks like all connected up:</p>

<p><amp-img src="/media/raspberry-pi-relay.jpg" alt="Raspberry Pi Connected to Relay and Garage Door" width="600" height="800" layout="responsive"><noscript><img src="/media/raspberry-pi-relay.jpg" alt="Raspberry Pi Connected to Relay and Garage Door" width="600" height="800"></noscript></amp-img></p>

<h2 id="test">Test</h2>

<ol>
  <li>Open http://[ip_address]:3000/ and click the “Relay 1” button. The garage door should open! Press it again and the door should close!</li>
</ol>

<p>Here’s a video showing the final setup:</p>

<amp-youtube width="560" height="315" layout="responsive" data-videoid="yMMDJPVJ0d4"></amp-youtube>

<h2 id="going-further">Going Further</h2>

<ol>
  <li>Get a <a href="https://www.amazon.com/dp/B0002BBQUU">project box like this one</a> and enclose everything nicely.</li>
  <li>Fork <a href="https://github.com/bradymholt/raspberrypi-relay-controller">raspberrypi-relay-controller</a> and customize the web interface, such as <a href="https://github.com/bradymholt/raspberrypi-relay-controller/blob/master/roles/relay-rest-api/templates/index.html#L41-L42">changing the button labels</a>. Then, simply run <code class="highlighter-rouge">./provision.sh</code> again to push out the updates.</li>
  <li>Integrate with another system utilizing the <a href="https://github.com/bradymholt/raspberrypi-relay-controller/blob/master/roles/relay-rest-api/templates/server.js.j2#L39-L40">simple REST API</a>.</li>
  <li>Get a <a href="https://www.amazon.com/Honeywell-951WG-WH-Recessed-Magnetic-Contact/dp/B001UKY1A4">magnetic contact switch like this</a> and use <a href="https://github.com/jperkin/node-rpio">rpio</a> to detect if the door is open or closed.</li>
</ol>

    </div>
    
    <footer class="site-footer">
    © 2019 Brady Holt
</footer>

    <amp-analytics type="googleanalytics">
        <script type="application/json">
        {
            "vars": {
            "account": "UA-19416043-2"
            },
            "triggers": {
            "trackPageview": {
                "on": "visible",
                "request": "pageview"
            }
            }
        }
        </script>
    </amp-analytics>
</body>

</html>