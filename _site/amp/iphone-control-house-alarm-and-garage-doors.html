<!doctype html>
<html amp lang="en">
<head>
    <meta charset="utf-8">
    <title>iPhone Control of House Alarm and Garage Doors</title>
    <link rel="canonical" href="https://www.geekytidbits.com/iphone-control-house-alarm-and-garage-doors/" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Poly' rel='stylesheet'>
    <style amp-custom>
        body { font-family: 'Poly', serif; }
        .site-header { background-color: #237ab2; color: #e7e9ec; padding: 5px; font-weight: 100; border-bottom: 3px solid #f68905; }
        .site-description { font-size: .5em;}        
        .post-content { padding: 10px; }
    </style>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
    <script async custom-element="amp-video" src="https://cdn.ampproject.org/v0/amp-video-0.1.js"></script>
    <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
</head>

<body>
    
    <h1 class="post-title">
        <header class="site-header">
    <div class="wrapper">
        <a class="site-title" href="/">
            <amp-img src="/media/geekytidbits.png" width="383" height="46" alt="Geeky Tidbits Logo" layout="responsive"><noscript><img src="/media/geekytidbits.png" width="383" height="46" alt="Geeky Tidbits Logo"></noscript></amp-img>
        </a>
        <div class="site-description">Tidbits on software development, technology, and other geeky stuff.</div>
    </div>
</header>

    </h1>
    <div class="post-content">
      <span>
          <i>Sep 28, 2011</i>
      </span>
      <p>About a year ago I bought a VISTA-ICM for my Honeywell VISTA-20P alarm system which is installed in my house. This little jewel connects the VISTA up to the internet to provide web interface control as well as event notifications. I originally bought it so I could self monitor my alarm and avoid the high fees of monitoring services. This is what it looks like:</p>

<p><a href="/media/VISTA-ICM.jpg"><amp-img class="size-full wp-image-637 aligncenter" title="VISTA-ICM" alt="" src="/media/VISTA-ICM.jpg" width="300" height="240" layout="responsive"><noscript><img class="size-full wp-image-637 aligncenter" title="VISTA-ICM" alt="" src="/media/VISTA-ICM.jpg" width="300" height="240"></noscript></amp-img></a></p>

<p>The setup was easy and it started working within 15 minutes of opening the box up. I set it up to send emails to my cell phone email address so that text messages would be sent when an alarm occured. I tested faulting the system and sure enough I got a text message within seconds of the alarm going off. Also, one time my wife and I were at the airport about to go on a trip and realized we forgot to arm the alarm. I pulled up web interface from my cell phone web browser and was able to arm it. Admittedly, the web interface was not user friendly but it got the job done.</p>

<p>Then I started thinking about writing and interface for the iPhone so that it would be much more usable from my phone.  Also, I wanted to handle sending the notifications on my own so I didn’t have to worry about them ceasing to work some random day since the delivery mechanism relies upon the vendor’s API.  As an added bonus, I wanted to control my garage doors as well since the VISTA panel has built-in ability to send X10 commands.</p>

<p>Searching around, I found that a guy named Tomi Blinnikka reverse engineered the VISTA-ICM and graciously posted a C# library/app to  to interface with it here: <a href="http://bliny.net/blog/post/h-Vista-ICM-network.aspx">http://bliny.net/blog/post/HoneywellAdemco-Vista-ICM-network.aspx</a> .  Many thanks Tomi!  Looking at his code is pretty interesting because it details how the ICM works by broadcasting UDP multicast packets to communicate what is happening with the alarm.</p>

<p>I wrote several applications that utilize this library to enable me to have full control of my VISTA alarm system.  These apps are running on my “always on” <a href="/my-pogoplug-geek-toy/" target="_blank">PogoPlug server</a>.</p>

<h2 id="the-solution">The Solution</h2>

<ol>
  <li>
<strong>AlarmServer</strong> – A service /daemon that constantly runs.  It sends notifications on alarm events, and allows clients to connect via named pipes to send commands to the alarm.  It has integrated support for <a href="http://www.prowlapp.com/" target="_blank">Prowl</a>, so it can send push notifications to iOS.</li>
  <li>
<strong>AlarmClient</strong> - A command line client for the AlarmServer.  I use this app in conjunction with a cron job at night to automatically arm my alarm in STAY mode before bed.<br>
    **</li>
  <li>
<strong>AlarmWeb</strong> – An iPhone optimized HTML5 web app that provides a web client for the AlarmServer.  It took several iterations to get this app just how I wanted it but it now works very well.  The display  (i.e. “Ready to Arm”, “ARMED STAY”, etc.) is updated quickly with a long polling request.  Here is what it looks like on my phone:</li>
</ol>

<p><a href="/media/20110827-102534.jpg"><amp-img class="size-full aligncenter" alt="20110827-102534.jpg" src="/media/20110827-102534.jpg" width="384" height="576" layout="responsive"><noscript><img class="size-full aligncenter" alt="20110827-102534.jpg" src="/media/20110827-102534.jpg" width="384" height="576"></noscript></amp-img></a></p>

<h2 id="garage-door-control">Garage Door Control</h2>

<p>What are those “Left / Right Garage” buttons, you might ask.  Pushing those actually open or close (toggle) my garage doors.  Yes, totally cool!  In a nutshell,  I have 2 X10 relay modules (<strong>X10</strong> <strong>PUM01</strong>) hooked up to each of my garage doors.  The VISTA-20P panel has built-in ability to send X10 commands which can control those 2 relay modules attached to my garages.  You must have the optional <strong>1361X10 </strong>transformer hooked up to the VISTA panel to enable it to send the X10 commands.  When I press one of the blue buttons, a command it sent to the panel through the VISTA-ICM module (just like any other command but with a special syntax) and then the X10 signals are sent.  Additionally, I have 2 wireless door transmitters (Honeywell 5816) hooked up to the garage doors so that I can check their status.  If one of the doors is open it shows as a fault on the alarm display and therefore I can see it using my AlarmWeb app.</p>

<h2 id="in-action">In action</h2>

<p>With all the apps hooked up and running, I am able to do some pretty cool stuff:</p>

<ul>
  <li>iPhone (browser) control of my alarm over the internet or from my couch.  I can arm, disarm, etc.</li>
  <li>Open and close my garage doors.</li>
  <li>Check to see if I forgot to close my garage door(s) when I am away from home.</li>
  <li>Auto arm alarm in STAY mode each evening before bed (using cron/AlarmClient)</li>
  <li>Send a notification if I left the garage door(s) open after leaving the house and arming the alarm.  This is accomplished by the AlarmServer waiting 5 minutes after an ARM AWAY event and then checking for a garage door(s) fault.  If either of them are faulted (open) then a notification is sent that says “Hey, you left the garage door(s) open!”).  Since I am able to control the garage doors I could simply pull up the AlarmWeb interface on my iPhone from my car and shut the doors.</li>
  <li>Auto arm alarm in STAY mode each weekday morning after the garage door closes.  Since my wife stays home with the kiddo, I want the alarm to be armed in STAY mode after I leave for work.  So that I don’t forget to do this, I have AlarmServer configured to watch for a garage door(s) fault between certain hours of the morning (weekdays only) and to arm the alarm after the fault is cleared (garage door closes).  So, this means I don’t have to remember to arm the alarm in the morning as it is automatically handled.</li>
</ul>

<h2 id="download">Download</h2>

<p>For anyone interested, the solution is here: <strike>VISTA_Alarm.zip</strike>. <strong>UPDATE: Please <a href="/vistaicm-server/">take a look at my updated solution called vistaicm-server</a>.</strong>  I have removed / changed all sensitive information (i.e. alarm passwords, IP addresses, Prowl api key, etc.) as I obviously don’t want this info publicly available!</p>


    </div>
    
    <footer class="site-footer">
    © 2019 Brady Holt
</footer>

    <amp-analytics type="googleanalytics">
        <script type="application/json">
        {
            "vars": {
            "account": "UA-19416043-2"
            },
            "triggers": {
            "trackPageview": {
                "on": "visible",
                "request": "pageview"
            }
            }
        }
        </script>
    </amp-analytics>
</body>

</html>